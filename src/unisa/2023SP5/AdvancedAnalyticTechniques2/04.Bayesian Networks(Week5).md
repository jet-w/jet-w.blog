---
title: 03.Bayesian networks(W5)
index: true
icon: "/assets/icon/common/data-mining.svg"
icon-size: "4rem"
author: Haiyue
date: 2023-08-25
#sidebar: false
category:
  - slides
---

## What's causality
`X` causes `Y` <span style="color:red;font-weight:bold">iff (if noly if)</span> there is some <span style="color:orange">manipulation</span> of `X` <span style="color:orange">leading to a change</span> in the probability distribution of `Y`.   *(Judea Pearl, 2000; Neapolitan, 2003)*

## How to discover causality?
**The gold standard method**: <span style="color:red">A randomized controlled experiment (RCE).</span>
::: warning The reasons for the unavailability of the experiments.
**Infeasible**
**Unethical**
**Expensive**
:::

## What's the IDA(Intervention calculus when the DAG is Absent)
The purpose of IDA in this context is to provide a <span style="color:orange">methodological framework</span> for inferring causality in situations where a `DAG` cannot be fully constructed.
::: info Steps for IDA
1. Use the `PC` algorithm to learn the `CPDAG`(Completed Partially Directed Acyclic Graph).
2. `Infer the causal effects`, e.g. eff(X2, Y), in all DAGs in the equivalent class
3. Find the `lower bound` of causal effects.
:::

### Causal inference - IDA
![Causal inference](/data/unisa/AdvancedAnalytic2/week5/causal-inference.png =400x)

## Local structure learning algorithms
- A major weakness of `PC` algorithm
    - Time complexity is exponential to the number of variables.
- Fix a variable and find parent and child nodes of the node. 
    - Both PC-Simple and Hiton-PC have polynomial time complexity with the number of variables. 

### 1. `PC` algorithm
![PC Algorithm](/data/unisa/AdvancedAnalytic2/week5/PC-algorithm.png =400x)

#### Steps of Example
Initial: Let the $Z$ be the target, $k=0, PC^0 = {A,B,C,D,E,F,G,H}$.
1. Test the independence between $Z$ with each variable.
    * ${H,D,E}$ are independent of Z
    * $k=1, PC^1 = {A,B,C,D,E,F,G,H}$
2. Test the independence between $Z$ with each variable given another variable.
    * $G$ is indenpendent of $Z$ given $F$.
    * $k=2, PC^2 = {A,B,C,F}$
3. Test the independence between $Z$ with each variable given another two variables.
    * $A$ is independent of $Z$ given ${B,C}$
    * $k=3, PC^3 = {B,C,F}$
4. Since $|PC^3| = k (k=3)$, the program is terminated
$PC = {B,C,F}$

### 2. `Hiton-PC` algorithm
![Hiton-PC Algorithm](/data/unisa/AdvancedAnalytic2/week5/Hiton-PC-algorithm.png =400x)

#### Steps of Example
Initial: Let the $Z$ be the target, $max_k = 2$, $OPEN = [B,C,A,G,F], PC={}$
**OPEN sorted in descending order of association strength**

1. Set $OPEN = [C,A,G,F], PC={B}$
    
2. Test the independence between $C$ with $Z$ given by $B$
    * It's not independence.
    * $OPEN = [A,G,F], PC={B,C}$

3. Test the independence between $A$ with $Z$ given by the combination from $PC$.
    * $A$ is independent of $Z$ given by ${B,C}$
    * Remove $A$ from $OPEN$
    * $OPEN = [G,F], PC={B,C}$
4. Test the independence between $G$ with $Z$ given by the combination from $PC$.
    * It's not independence.
    * $OPEN = [F], PC={B,C,G}$
5. Test the independence between $F$ with $Z$ given by the combination from $PC$.
    * It's not independence.
    * $OPEN = [], PC={B,C,G,F}$

6. Test the independence between item from $PC$ (Pick up item from left to right) given by the combination of other right items.
    * 1. test the independence between $B$ with $Z$ given by combination of ${C,G,F}$
    * 2. test the independence between $B$ with $C$ given by combination of ${G,F}$
    * 3. test the independence between $B$ with $G$ given by combination of ${F}$
    * $G$ is indenpendent given by $F$
    $PC = {B,C,F}$

### Cohort study
![Cohorts](/data/unisa/AdvancedAnalytic2/week5/Cohorts.png)

**Cohorts**: share common characteristics but exposed or not exposed.
Determine how the exposure causes an outcome.
**Measure**: $\text{odds ratio} = \frac{(a/b)}{(c/d)}$
| | Diseased| Healthy |
| -- | -- | -- |
| Exposed | a | b |
| Not Exposed | c | d |
#### Limitations of cohort study

* Need to know a <span style="color:orange">hypothesis beforehand</span>
* <span style="color:orange">Domain experts</span> determine the <span style="color:orange">control variables</span>.
* <span style="color:orange">Collect</span> data and <span style="color:orange">test</span> the hypothesis.  
* Not for data exploration. 

<span style="color:red">We need</span>:
* Given a dataset without any hypotheses.
* An automatic method to find and validate hypotheses.
* For data exploration.


#### Matches


## References
01. **Week 5 Slides from [Thuc](https://people.unisa.edu.au/thuc.le) (SP52023)**
02. [贝叶斯理论：Data Science必备技能，数据分析师为你揭开 Bayes 统计的神秘面纱（第426期](https://www.youtube.com/watch?v=MvMkAI_-38A)